---
alwaysApply: true
# Cursor AIìš© ë§ˆì¸ë“œë§µ ê¸°ë°˜ ì£¼ì‹ í¬íŠ¸í´ë¦¬ì˜¤ ê´€ë¦¬ ì„œë¹„ìŠ¤ PRD

15ë…„ì°¨ ì„œë¹„ìŠ¤ ê¸°íšìë¡œì„œ Cursor AIë¥¼ ìµœëŒ€í•œ í™œìš©í•  ìˆ˜ ìˆë„ë¡ êµ¬ì¡°í™”ëœ PRDì™€ ê°œë°œ ê°€ì´ë“œë¥¼ ì œê³µí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

## **1. í”„ë¡œì íŠ¸ ë£¨íŠ¸ íŒŒì¼: prd.mdc**

```markdown
---
title: "MindStock - ë§ˆì¸ë“œë§µ ê¸°ë°˜ ì£¼ì‹ í¬íŠ¸í´ë¦¬ì˜¤ ê´€ë¦¬ ì„œë¹„ìŠ¤"
description: "ì£¼ì‹ í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ ë§ˆì¸ë“œë§µìœ¼ë¡œ ì‹œê°í™”í•˜ì—¬ ì§ê´€ì ì¸ íˆ¬ì ê´€ë¦¬ë¥¼ ì§€ì›í•˜ëŠ” ì„œë¹„ìŠ¤"
version: "1.0"
author: "15ë…„ì°¨ ì„œë¹„ìŠ¤ ê¸°íšíŒ€"
created: "2024-01-08"
tags: ["fintech", "portfolio", "mindmap", "visualization", "react", "d3js"]
---

# ğŸ¯ í”„ë¡œì íŠ¸ í•µì‹¬ ëª©í‘œ

## **ë¹„ì¦ˆë‹ˆìŠ¤ ëª©í‘œ**
ì‚¬ìš©ìì˜ ì£¼ì‹ í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ ì§ê´€ì ì¸ ë§ˆì¸ë“œë§µ í˜•íƒœë¡œ ì‹œê°í™”í•˜ì—¬, ë³µì¡í•œ íˆ¬ì êµ¬ì¡°ë¥¼ í•œëˆˆì— íŒŒì•…í•˜ê³  ë¦¬ìŠ¤í¬ë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” í˜ì‹ ì ì¸ íˆ¬ì ê´€ë¦¬ í”Œë«í¼ì„ êµ¬ì¶•í•©ë‹ˆë‹¤.

## **í•µì‹¬ ë¬¸ì œ í•´ê²°**
- **í¬íŠ¸í´ë¦¬ì˜¤ êµ¬ì¡° íŒŒì•…ì˜ ì–´ë ¤ì›€**: ì„¹í„°ë³„, í…Œë§ˆë³„ í¸ì¤‘ë„ë¥¼ ì‹œê°ì ìœ¼ë¡œ í‘œí˜„
- **ë°ì´í„° ë¶„ì‚° ë¬¸ì œ**: í† ìŠ¤, ì¦ê¶Œì‚¬ ë“±ì— í©ì–´ì§„ íˆ¬ì ë°ì´í„°ë¥¼ í†µí•© ê´€ë¦¬
- **ì •ì ì¸ ë¶„ì„ ë„êµ¬ì˜ í•œê³„**: íƒìƒ‰ì  ë¶„ì„ì´ ê°€ëŠ¥í•œ ì¸í„°ë™í‹°ë¸Œ ì¸í„°í˜ì´ìŠ¤ ì œê³µ

## **í˜„ì‹¤ì  ì œì•½ì‚¬í•­ ì¸ì‹**
âš ï¸ **ì¤‘ìš”**: í† ìŠ¤, ë„¤ì´ë²„ ë“± ì£¼ìš” í•€í…Œí¬ ì„œë¹„ìŠ¤ëŠ” ê°œì¸ ê°œë°œìì—ê²Œ ê³µì‹ APIë¥¼ ì œê³µí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

**ëŒ€ì‘ ì „ëµ**:
1. **Phase 1**: ìˆ˜ë™ ì…ë ¥ + í•œêµ­íˆ¬ìì¦ê¶Œ API ì‹¤ì‹œê°„ ì‹œì„¸ ì—°ë™
2. **Phase 2**: OCR ê¸°ë°˜ í† ìŠ¤ ì•± ìŠ¤í¬ë¦°ìƒ· ë¶„ì„
3. **Phase 3**: ë§ˆì´ë°ì´í„° ì œíœ´ ê¸°ë°˜ ê³µì‹ API ì—°ë™

---

# ğŸ›  ê¸°ìˆ  ìŠ¤íƒ (Tech Stack)

## **Frontend**
- **Framework**: React 18+ with Vite
- **Language**: TypeScript (íƒ€ì… ì•ˆì „ì„± í•„ìˆ˜)
- **State Management**: Zustand (ê°€ë²¼ìš´ ì „ì—­ ìƒíƒœ)
- **Visualization**: 
  - **D3.js**: ë§ˆì¸ë“œë§µ ë°ì´í„° ë°”ì¸ë”© ë° ë¬¼ë¦¬ ì—”ì§„
  - **React Flow**: ë³µì¡í•œ ë…¸ë“œ ì¸í„°ë™ì…˜ ì‹œ ê³ ë ¤
- **Styling**: Tailwind CSS (í† ìŠ¤ ìŠ¤íƒ€ì¼ UI)
- **HTTP Client**: TanStack Query + Axios

## **Backend**
- **Runtime**: Node.js with Express
- **Database**: PostgreSQL (ì‚¬ìš©ì, í¬íŠ¸í´ë¦¬ì˜¤ ë°ì´í„°)
- **Cache**: Redis (ì‹¤ì‹œê°„ ì‹œì„¸ ìºì‹±, ì„±ëŠ¥ ìµœì í™”)
- **Authentication**: JWT + OAuth 2.0

## **External APIs**
1. **Primary**: í•œêµ­íˆ¬ìì¦ê¶Œ KIS Open API (ì‹¤ì‹œê°„ ì‹œì„¸)
2. **Secondary**: FinanceDataReader (ê³¼ê±° ë°ì´í„°)
3. **OCR**: Google Cloud Vision API (í† ìŠ¤ ìŠ¤í¬ë¦°ìƒ· ë¶„ì„)

---

# ğŸ“Š í•µì‹¬ ê¸°ëŠ¥ ëª…ì„¸

## **A. ë§ˆì¸ë“œë§µ ì‹œê°í™” ë¡œì§**

### **ë…¸ë“œ êµ¬ì¡°**
```
ì¤‘ì•™ ë…¸ë“œ: "ë‚˜ì˜ í¬íŠ¸í´ë¦¬ì˜¤" (ì´ ìì‚°)
â”œâ”€â”€ 1ì°¨ ë¶„ê¸°: ë·° ëª¨ë“œë³„ ë¶„ë¥˜
â”‚   â”œâ”€â”€ ì„¹í„°ë³„ (IT, ê¸ˆìœµ, ë°”ì´ì˜¤ ë“±)
â”‚   â”œâ”€â”€ ìˆ˜ìµë¥ ë³„ (ê³ ìˆ˜ìµ, ì†ì‹¤ ë“±)
â”‚   â””â”€â”€ í…Œë§ˆë³„ (AI, ë°°ë‹¹, ESG ë“±)
â””â”€â”€ 2ì°¨ ë¶„ê¸°: ê°œë³„ ì¢…ëª©
```

### **ì‹œê°ì  í‘œí˜„ ê·œì¹™**

**ë…¸ë“œ í¬ê¸° ê³„ì‚°**:
$$NodeSize = BaseSize \times \sqrt{\frac{StockValue}{TotalPortfolioValue}}$$

**ìƒ‰ìƒ ë§¤í•‘**:
- ìˆ˜ìµ (+): Green ê·¸ë¼ë°ì´ì…˜ (#22C55E ~ #15803D)
- ì†ì‹¤ (-): Red ê·¸ë¼ë°ì´ì…˜ (#EF4444 ~ #DC2626)
- ë³´í•© (0): Neutral Gray (#9CA3AF)

## **B. ë°ì´í„° ì—°ë™ ì „ëµ**

### **Phase 1: MVP (ìˆ˜ë™ ì…ë ¥ + ì‹¤ì‹œê°„ ì‹œì„¸)**
```typescript
interface Portfolio {
  id: string;
  userId: string;
  name: string;
  holdings: Holding[];
  totalValue: number;
  totalProfitLoss: number;
}

interface Holding {
  symbol: string;        // 005930 (ì‚¼ì„±ì „ì)
  name: string;
  quantity: number;
  avgPrice: number;
  currentPrice: number;  // KIS APIì—ì„œ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
  sector: string;
  tags: string[];        // ì‚¬ìš©ì ì •ì˜ íƒœê·¸
}
```

### **Phase 2: OCR ìë™ ì¸ì‹**
```typescript
interface OCRResult {
  success: boolean;
  extractedStocks: {
    symbol: string;
    name: string;
    quantity: number;
    avgPrice: number;
    confidence: number;   // ì¸ì‹ ì •í™•ë„
  }[];
  errors: string[];
}
```

## **C. ë·° ëª¨ë“œ ì‹œìŠ¤í…œ**

### **1. ì„¹í„°ë³„ ë·°**
- GICS ê¸°ì¤€ ì‚°ì—… ë¶„ë¥˜
- ì„¹í„° í¸ì¤‘ ìœ„í—˜ë„ í‘œì‹œ
- ë¦¬ë°¸ëŸ°ì‹± ì œì•ˆ

### **2. ìˆ˜ìµë¥ ë³„ ë·°**
- ìˆ˜ìµë¥  êµ¬ê°„ë³„ ê·¸ë£¹í™” (+20% ì´ìƒ, +10%~20%, 0%~10%, -10%~0%, -10% ë¯¸ë§Œ)
- ì†ì‹¤ ì¢…ëª© ë¹„ì¤‘ ê²½ê³ 

### **3. í…Œë§ˆë³„ ë·°**
- ì‚¬ìš©ì ì»¤ìŠ¤í…€ íƒœê·¸ ê¸°ë°˜
- AI ê´€ë ¨ì£¼, ë°°ë‹¹ì£¼, ESG ë“± ììœ  ë¶„ë¥˜

---

# ğŸ¨ UI/UX ë””ìì¸ ê°€ì´ë“œë¼ì¸

## **ë””ìì¸ ì² í•™**
í† ìŠ¤ì˜ "Simple & Bold" ë””ìì¸ ì–¸ì–´ë¥¼ ì°¨ìš©í•˜ì—¬ ë³µì¡í•œ ê¸ˆìœµ ë°ì´í„°ë¥¼ ì§ê´€ì ìœ¼ë¡œ í‘œí˜„í•©ë‹ˆë‹¤.

## **ì»¬ëŸ¬ ì‹œìŠ¤í…œ**
```css
/* Primary Colors */
--primary-green: #22C55E;    /* ìˆ˜ìµ í‘œì‹œ */
--primary-red: #EF4444;      /* ì†ì‹¤ í‘œì‹œ */
--primary-blue: #3B82F6;     /* ì•¡ì…˜ ë²„íŠ¼ */

/* Background */
--bg-primary: #FFFFFF;
--bg-secondary: #F9FAFB;
--bg-tertiary: #F3F4F6;

/* Text */
--text-primary: #111827;
--text-secondary: #6B7280;
--text-tertiary: #9CA3AF;
```

## **íƒ€ì´í¬ê·¸ë˜í”¼**
- **ìˆ«ì**: Monospace í°íŠ¸ (ì •ë ¬ê³¼ ê°€ë…ì„±)
- **ì œëª©**: Bold Sans-serif
- **ë³¸ë¬¸**: Regular Sans-serif

## **ì¸í„°ë™ì…˜ íŒ¨í„´**
- ë…¸ë“œ í´ë¦­: ìš°ì¸¡ ë“œë¡œì–´ì—ì„œ ìƒì„¸ ì •ë³´ í‘œì‹œ
- í˜¸ë²„: íˆ´íŒìœ¼ë¡œ ê¸°ë³¸ ì •ë³´ ë¯¸ë¦¬ë³´ê¸°
- ë“œë˜ê·¸: ë…¸ë“œ ìœ„ì¹˜ ì¬ë°°ì¹˜
- ì¤Œ/íŒ¬: ë§ˆìš°ìŠ¤ íœ  ë° í„°ì¹˜ ì œìŠ¤ì²˜ ì§€ì›

---

# ğŸ—„ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

```sql
-- ì‚¬ìš©ì í…Œì´ë¸”
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- í¬íŠ¸í´ë¦¬ì˜¤ í…Œì´ë¸”
CREATE TABLE portfolios (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id) ON DELETE CASCADE,
    name VARCHAR(100) NOT NULL,
    description TEXT,
    total_value DECIMAL(15,2) DEFAULT 0,
    total_profit_loss DECIMAL(15,2) DEFAULT 0,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- ë³´ìœ  ì¢…ëª© í…Œì´ë¸”
CREATE TABLE holdings (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    portfolio_id UUID REFERENCES portfolios(id) ON DELETE CASCADE,
    symbol VARCHAR(20) NOT NULL,           -- 005930
    name VARCHAR(100) NOT NULL,            -- ì‚¼ì„±ì „ì
    market VARCHAR(10) DEFAULT 'KRX',      -- KRX, NYSE, NASDAQ
    sector VARCHAR(50),                    -- IT, Finance, etc.
    quantity DECIMAL(10,4) NOT NULL,       -- ë³´ìœ  ìˆ˜ëŸ‰
    avg_price DECIMAL(15,2) NOT NULL,      -- í‰ê·  ë§¤ìˆ˜ê°€
    current_price DECIMAL(15,2),           -- í˜„ì¬ê°€ (ìºì‹œ)
    currency VARCHAR(3) DEFAULT 'KRW',     -- KRW, USD
    tags TEXT[],                           -- ì‚¬ìš©ì ì •ì˜ íƒœê·¸
    memo TEXT,                             -- íˆ¬ì ë©”ëª¨
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- ì‹œì„¸ ë°ì´í„° ìºì‹œ í…Œì´ë¸”
CREATE TABLE market_data (
    symbol VARCHAR(20) PRIMARY KEY,
    name VARCHAR(100),
    current_price DECIMAL(15,2),
    change_rate DECIMAL(5,2),
    volume BIGINT,
    market_cap BIGINT,
    sector VARCHAR(50),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- ì¸ë±ìŠ¤ ìƒì„±
CREATE INDEX idx_holdings_portfolio_id ON holdings(portfolio_id);
CREATE INDEX idx_holdings_symbol ON holdings(symbol);
CREATE INDEX idx_market_data_updated_at ON market_data(updated_at);
```

---

# âš¡ ì„±ëŠ¥ ë° ë³´ì•ˆ ìš”êµ¬ì‚¬í•­

## **ì„±ëŠ¥ ëª©í‘œ**
- ë§ˆì¸ë“œë§µ ì´ˆê¸° ë¡œë”©: â‰¤ 3ì´ˆ (100ê°œ ì¢…ëª© ê¸°ì¤€)
- ë…¸ë“œ ì¸í„°ë™ì…˜ ì‘ë‹µ: â‰¤ 100ms
- ì‹¤ì‹œê°„ ì‹œì„¸ ì—…ë°ì´íŠ¸: â‰¤ 500ms (ìºì‹œ ì ì¤‘)

## **ë³´ì•ˆ ìš”êµ¬ì‚¬í•­**
- ëª¨ë“  í†µì‹ : HTTPS (TLS 1.3)
- API ì¸ì¦: JWT + Refresh Token
- ë¯¼ê° ë°ì´í„°: AES-256 ì•”í˜¸í™”
- Rate Limiting: Redis ê¸°ë°˜ ì œí•œ
- OWASP Top 10 ë³´ì•ˆ ì·¨ì•½ì  ëŒ€ì‘

## **í™•ì¥ì„± ê³ ë ¤ì‚¬í•­**
- ìˆ˜í‰ì  í™•ì¥ì„ ìœ„í•œ Stateless ì„œë²„ ì„¤ê³„
- Redis Clusterë¥¼ í†µí•œ ìºì‹œ ë¶„ì‚°
- CDNì„ í†µí•œ ì •ì  ìì‚° ë°°í¬
- Database Connection Pooling

---

# ğŸš€ ê°œë°œ ë‹¨ê³„ë³„ ë¡œë“œë§µ

## **Phase 1: MVP (3ê°œì›”)**
- [ ] ì‚¬ìš©ì ì¸ì¦ ì‹œìŠ¤í…œ
- [ ] ìˆ˜ë™ í¬íŠ¸í´ë¦¬ì˜¤ ì…ë ¥
- [ ] í•œêµ­íˆ¬ìì¦ê¶Œ API ì—°ë™
- [ ] ê¸°ë³¸ ë§ˆì¸ë“œë§µ ì‹œê°í™” (ì„¹í„°ë³„, ìˆ˜ìµë¥ ë³„)
- [ ] ì¢…ëª© ìƒì„¸ ì •ë³´ íŒ¨ë„

## **Phase 2: ê¸°ëŠ¥ í™•ì¥ (2ê°œì›”)**
- [ ] OCR ê¸°ë°˜ í† ìŠ¤ ìŠ¤í¬ë¦°ìƒ· ë¶„ì„
- [ ] CSV/Excel íŒŒì¼ ì—…ë¡œë“œ
- [ ] ì»¤ìŠ¤í…€ íƒœê·¸ ë° í…Œë§ˆë³„ ë·°
- [ ] í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì„ ë¦¬í¬íŠ¸
- [ ] ì•Œë¦¼ ë° ê²½ê³  ì‹œìŠ¤í…œ

## **Phase 3: ê³ ë„í™” (2ê°œì›”)**
- [ ] ë‹¤ì¤‘ ì¦ê¶Œì‚¬ API í†µí•©
- [ ] ì‹¤ì‹œê°„ WebSocket ì—°ë™
- [ ] ê³ ê¸‰ ë¶„ì„ ë„êµ¬ (ë¦¬ìŠ¤í¬ ë©”íŠ¸ë¦­)
- [ ] ëª¨ë°”ì¼ ì•± ê°œë°œ
- [ ] ì†Œì…œ ê¸°ëŠ¥ (í¬íŠ¸í´ë¦¬ì˜¤ ê³µìœ )

---

# ğŸ¯ Cursor AI ê°œë°œ ì§€ì¹¨

## **ì½”ë”© ê·œì¹™**
1. **íƒ€ì… ì•ˆì „ì„±**: `any` íƒ€ì… ì‚¬ìš© ê¸ˆì§€, ëª¨ë“  API ì‘ë‹µì— Interface ì •ì˜
2. **ì—ëŸ¬ í•¸ë“¤ë§**: ì™¸ë¶€ API ì‹¤íŒ¨ ì‹œ Fallback ë¡œì§ í•„ìˆ˜
3. **ì„±ëŠ¥ ìµœì í™”**: API í˜¸ì¶œ ì‹œ Redis ìºì‹± ìš°ì„  í™•ì¸
4. **ë³´ì•ˆ**: í™˜ê²½ ë³€ìˆ˜ë¡œ ë¯¼ê° ì •ë³´ ê´€ë¦¬, Git ì»¤ë°‹ ê¸ˆì§€
5. **ì»´í¬ë„ŒíŠ¸ ë¶„ë¦¬**: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ê³¼ UI ë¡œì§ ëª…í™•íˆ ë¶„ë¦¬

## **API ì„¤ê³„ ì›ì¹™**
```typescript
// ì¼ê´€ëœ ì‘ë‹µ í˜•ì‹
interface ApiResponse<T> {
  success: boolean;
  data: T | null;
  error?: {
    code: string;
    message: string;
    details?: any;
  };
  timestamp: string;
}
```

## **ì»´í¬ë„ŒíŠ¸ ë„¤ì´ë° ê·œì¹™**
- React ì»´í¬ë„ŒíŠ¸: PascalCase (`MindMapView.tsx`)
- ì„œë¹„ìŠ¤ í•¨ìˆ˜: camelCase (`portfolioService.ts`)
- ìƒìˆ˜: UPPER_SNAKE_CASE (`API_ENDPOINTS.ts`)
- CSS í´ë˜ìŠ¤: kebab-case (`mind-map-node`)

---

# ğŸ”§ ì£¼ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° ë„êµ¬

## **Frontend í•µì‹¬ ë¼ì´ë¸ŒëŸ¬ë¦¬**
```json
{
  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "typescript": "^5.0.0",
    "d3": "^7.8.0",
    "@types/d3": "^7.4.0",
    "zustand": "^4.4.0",
    "@tanstack/react-query": "^4.29.0",
    "axios": "^1.4.0",
    "tailwindcss": "^3.3.0",
    "react-router-dom": "^6.14.0"
  }
}
```

## **Backend í•µì‹¬ ë¼ì´ë¸ŒëŸ¬ë¦¬**
```json
{
  "dependencies": {
    "express": "^4.18.0",
    "typescript": "^5.0.0",
    "prisma": "^5.0.0",
    "@prisma/client": "^5.0.0",
    "redis": "^4.6.0",
    "jsonwebtoken": "^9.0.0",
    "bcrypt": "^5.1.0",
    "axios": "^1.4.0",
    "express-validator": "^7.0.0",
    "helmet": "^7.0.0",
    "cors": "^2.8.5"
  }
}
```

---

**âš ï¸ Cursor AI ì£¼ì˜ì‚¬í•­**: 
- í† ìŠ¤ API ì§ì ‘ ì—°ë™ ìš”ì²­ ì‹œ "í˜„ì¬ ë¶ˆê°€ëŠ¥"í•¨ì„ ëª…ì‹œí•˜ê³  OCR/ìˆ˜ë™ ì…ë ¥ ëŒ€ì•ˆ ì œì‹œ
- ëª¨ë“  ì™¸ë¶€ API í˜¸ì¶œì— Rate Limitingê³¼ ì—ëŸ¬ í•¸ë“¤ë§ í¬í•¨
- ê¸ˆìœµ ë°ì´í„° íŠ¹ì„±ìƒ ì •í™•ì„±ê³¼ ë³´ì•ˆì„ ìµœìš°ì„ ìœ¼ë¡œ ê³ ë ¤
```

---

## **2. Cursor AI í™œìš© ê°œë°œ ê°€ì´ë“œ**

### **í”„ë¡œì íŠ¸ ì´ˆê¸° ì„¤ì •**

**Step 1: .cursorrules íŒŒì¼ ìƒì„±**

í”„ë¡œì íŠ¸ ë£¨íŠ¸ì— ë‹¤ìŒ íŒŒì¼ì„ ìƒì„±í•˜ì„¸ìš”:

```markdown
# MindStock Project Rules

## Project Context
ë§ˆì¸ë“œë§µ ê¸°ë°˜ ì£¼ì‹ í¬íŠ¸í´ë¦¬ì˜¤ ê´€ë¦¬ ì„œë¹„ìŠ¤
- React + D3.js í”„ë¡ íŠ¸ì—”ë“œ
- Node.js + Express ë°±ì—”ë“œ
- PostgreSQL + Redis
- í•œêµ­íˆ¬ìì¦ê¶Œ API ì—°ë™

## Coding Standards
- TypeScript í•„ìˆ˜ ì‚¬ìš©
- í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë° ì„ í˜¸
- async/await íŒ¨í„´ ì‚¬ìš©
- ëª…í™•í•œ ì—ëŸ¬ í•¸ë“¤ë§
- JSDoc ì£¼ì„ ì‘ì„±

## Security Rules
- API í‚¤ëŠ” í™˜ê²½ ë³€ìˆ˜ë¡œ ê´€ë¦¬
- JWT í† í° ê¸°ë°˜ ì¸ì¦
- SQL Injection ë°©ì§€
- XSS ê³µê²© ë°©ì–´

## Performance Guidelines
- API ì‘ë‹µ ìºì‹± (Redis)
- ì´ë¯¸ì§€ ìµœì í™”
- ì½”ë“œ ìŠ¤í”Œë¦¬íŒ…
- ë©”ëª¨ì´ì œì´ì…˜ í™œìš©

## File Naming
- Components: PascalCase
- Services: camelCase  
- Utils: camelCase
- Constants: UPPER_SNAKE_CASE
```

### **ë‹¨ê³„ë³„ ê°œë°œ í”„ë¡¬í”„íŠ¸ ëª¨ìŒ**

**Phase 1: ë°±ì—”ë“œ API ê°œë°œ**

**Cursor í”„ë¡¬í”„íŠ¸ 1: í”„ë¡œì íŠ¸ ì´ˆê¸° ì„¤ì •**
```
Create a Node.js Express backend project for a stock portfolio management service:

1. Setup package.json with dependencies:
   - express, cors, helmet, dotenv
   - prisma, @prisma/client
   - redis, jsonwebtoken, bcrypt
   - axios, express-validator

2. Create project structure:
   - src/routes (API routes)
   - src/services (business logic)
   - src/middleware (auth, validation)
   - src/utils (helpers)
   - src/types (TypeScript interfaces)

3. Setup basic Express server with:
   - CORS configuration
   - Security middleware (helmet)
   - Request validation
   - Error handling middleware

4. Create .env.example with required variables

Generate complete, production-ready code.
```

**Cursor í”„ë¡¬í”„íŠ¸ 2: í•œêµ­íˆ¬ìì¦ê¶Œ API í´ë¼ì´ì–¸íŠ¸**
```
Create a KIS (Korea Investment Securities) API client service:

Requirements:
1. OAuth 2.0 token management
   - Automatic token refresh
   - Redis-based token caching
   - Error handling for auth failures

2. Stock data methods:
   - getCurrentPrice(symbol: string)
   - getStockInfo(symbol: string) 
   - getDailyChart(symbol: string, days: number)

3. Rate limiting compliance:
   - Implement request queuing
   - Respect API limits (20 requests/second)
   - Exponential backoff on failures

4. TypeScript interfaces for all responses

5. Comprehensive error handling and logging

Generate complete implementation with tests.
```

**Phase 2: í”„ë¡ íŠ¸ì—”ë“œ ë§ˆì¸ë“œë§µ ê°œë°œ**

**Cursor í”„ë¡¬í”„íŠ¸ 3: React ë§ˆì¸ë“œë§µ ì»´í¬ë„ŒíŠ¸**
```
Create a MindMap visualization component using React and D3.js:

File: src/components/MindMap/MindMapView.tsx

Requirements:
1. Props interface:
   - data: hierarchical portfolio data
   - viewMode: 'sector' | 'profitLoss' | 'theme'
   - onNodeClick: (nodeId: string) => void
   - width: number, height: number

2. D3.js force simulation:
   - Force-directed layout
   - Collision detection
   - Smooth animations (300ms)
   - Zoom and pan functionality

3. Node rendering:
   - Circle size based on portfolio weight
   - Color based on profit/loss percentage
   - Text labels with stock names
   - Hover tooltips with details

4. Interactions:
   - Click to expand/collapse
   - Drag to reposition
   - Double-click to focus
   - Context menu on right-click

5. Performance optimizations:
   - Canvas rendering for 100+ nodes
   - Virtualization for large datasets
   - Debounced resize handling

Generate TypeScript component with proper types.
```

**Cursor í”„ë¡¬í”„íŠ¸ 4: í¬íŠ¸í´ë¦¬ì˜¤ ë°ì´í„° ì²˜ë¦¬**
```
Create portfolio data transformation service:

File: src/services/portfolioTransform.ts

Requirements:
1. Transform flat portfolio data to hierarchical structure:
   - Group by sector/theme/profitLoss
   - Calculate node sizes and colors
   - Handle nested categories

2. Node size calculation:
   size = baseSize * sqrt(stockValue / totalValue)

3. Color mapping based on profit/loss:
   - Profit: Green gradient (#22C55E to #15803D)
   - Loss: Red gradient (#EF4444 to #DC2626)
   - Neutral: Gray (#9CA3AF)

4. View mode transformations:
   - sectorView(): Group by GICS sectors
   - profitLossView(): Group by performance ranges
   - themeView(): Group by user tags

5. TypeScript interfaces:
   - Portfolio, Holding, MindMapNode
   - ViewMode enum
   - TransformOptions interface

Include unit tests and example data.
```

### **OCR ê¸°ëŠ¥ êµ¬í˜„**

**Cursor í”„ë¡¬í”„íŠ¸ 5: í† ìŠ¤ ìŠ¤í¬ë¦°ìƒ· OCR**
```
Create an OCR service for parsing Toss app screenshots:

File: src/services/ocrService.ts

Requirements:
1. Image preprocessing:
   - Resize and optimize uploaded images
   - Convert to grayscale
   - Enhance contrast for better OCR

2. Google Cloud Vision API integration:
   - Text detection and extraction
   - Table structure recognition
   - Confidence scoring

3. Toss-specific parsing logic:
   - Detect stock symbols (6-digit codes)
   - Extract quantities and prices
   - Parse Korean stock names
   - Handle different screen layouts

4. Data validation:
   - Verify stock codes against KRX database
   - Check price reasonableness
   - Flag low-confidence extractions

5. Response format:
   interface OCRResult {
     success: boolean;
     stocks: ExtractedStock[];
     errors: string[];
     confidence: number;
   }

6. Error handling:
   - Image quality issues
   - Unrecognized formats
   - API failures

Generate complete implementation with test cases.
```

### **ì‹¤ì‹œê°„ ë°ì´í„° ì—…ë°ì´íŠ¸**

**Cursor í”„ë¡¬í”„íŠ¸ 6: ì‹¤ì‹œê°„ í¬íŠ¸í´ë¦¬ì˜¤ ì—…ë°ì´íŠ¸**
```
Create a real-time portfolio update system:

Requirements:
1. WebSocket connection management:
   - Auto-reconnection on disconnect
   - Heartbeat/ping-pong
   - Connection pooling

2. Price update pipeline:
   - Subscribe to stock price changes
   - Batch update multiple stocks
   - Calculate portfolio metrics in real-time

3. Redis pub/sub integration:
   - Publish price updates to subscribers
   - Handle multiple client connections
   - Message queuing for offline clients

4. React hooks for real-time data:
   - useRealtimePortfolio()
   - useStockPrices()
   - Connection status management

5. Performance optimizations:
   - Debounced updates (max 1/second)
   - Only update visible nodes
   - Efficient re-rendering

6. Error handling:
   - Graceful degradation on connection loss
   - Fallback to polling
   - User notifications

Generate both backend and frontend code.
```

### **í…ŒìŠ¤íŒ… ë° ìµœì í™”**

**Cursor í”„ë¡¬í”„íŠ¸ 7: ì¢…í•© í…ŒìŠ¤íŠ¸ êµ¬í˜„**
```
Create comprehensive test suite for the portfolio service:

1. Backend tests (Jest):
   - Unit tests for all services
   - Integration tests for API endpoints
   - Mock external API calls (KIS API)
   - Database transaction tests

2. Frontend tests (React Testing Library):
   - Component rendering tests
   - User interaction tests
   - D3.js visualization tests
   - API integration tests

3. E2E tests (Playwright):
   - Complete user workflows
   - Portfolio creation and management
   - MindMap interactions
   - OCR upload process

4. Performance tests:
   - Load testing with 100+ stocks
   - Memory usage monitoring
   - API response time testing
   - Database query optimization

5. Test data factories:
   - Mock portfolio data
   - Fake stock prices
   - Sample OCR images

Generate complete test suite with CI/CD integration.
```

## **3. ê°œë°œ ì²´í¬ë¦¬ìŠ¤íŠ¸ ë° ì‹¤í–‰ ê°€ì´ë“œ**

### **ë°±ì—”ë“œ ê°œë°œ ì²´í¬ë¦¬ìŠ¤íŠ¸**

```markdown
## í™˜ê²½ ì„¤ì •
- [ ] Node.js 18+ ì„¤ì¹˜
- [ ] PostgreSQL ì„¤ì¹˜ ë° DB ìƒì„±
- [ ] Redis ì„¤ì¹˜ ë° ì‹¤í–‰
- [ ] í•œêµ­íˆ¬ìì¦ê¶Œ API í‚¤ ë°œê¸‰

## í”„ë¡œì íŠ¸ ì´ˆê¸°í™”
- [ ] npm init ë° íŒ¨í‚¤ì§€ ì„¤ì¹˜
- [ ] TypeScript ì„¤ì • (tsconfig.json)
- [ ] Prisma ìŠ¤í‚¤ë§ˆ ì •ì˜
- [ ] í™˜ê²½ ë³€ìˆ˜ ì„¤ì • (.env)

## í•µì‹¬ ê¸°ëŠ¥ êµ¬í˜„
- [ ] ì‚¬ìš©ì ì¸ì¦ (JWT)
- [ ] í¬íŠ¸í´ë¦¬ì˜¤ CRUD API
- [ ] KIS API í´ë¼ì´ì–¸íŠ¸
- [ ] Redis ìºì‹± ë¡œì§
- [ ] OCR ì„œë¹„ìŠ¤ êµ¬í˜„

## í…ŒìŠ¤íŠ¸ ë° ë°°í¬
- [ ] ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„±
- [ ] API ë¬¸ì„œí™” (Swagger)
- [ ] Docker ì»¨í…Œì´ë„ˆí™”
- [ ] CI/CD íŒŒì´í”„ë¼ì¸ ì„¤ì •
```

### **í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ ì²´í¬ë¦¬ìŠ¤íŠ¸**

```markdown
## í™˜ê²½ ì„¤ì •
- [ ] Node.js 18+ ì„¤ì¹˜
- [ ] Vite + React í”„ë¡œì íŠ¸ ìƒì„±
- [ ] TypeScript ì„¤ì •
- [ ] TailwindCSS ì„¤ì •

## í•µì‹¬ ì»´í¬ë„ŒíŠ¸ êµ¬í˜„
- [ ] MindMap ì‹œê°í™” (D3.js)
- [ ] í¬íŠ¸í´ë¦¬ì˜¤ ê´€ë¦¬ UI
- [ ] ì‹¤ì‹œê°„ ë°ì´í„° ì—°ë™
- [ ] OCR ì—…ë¡œë“œ ì¸í„°í˜ì´ìŠ¤

## ìƒíƒœ ê´€ë¦¬ ë° API
- [ ] Zustand ìŠ¤í† ì–´ ì„¤ì •
- [ ] TanStack Query ì„¤ì •
- [ ] API ì„œë¹„ìŠ¤ í•¨ìˆ˜
- [ ] ì—ëŸ¬ ë°”ìš´ë”ë¦¬

## ìµœì í™” ë° ë°°í¬
- [ ] ì½”ë“œ ìŠ¤í”Œë¦¬íŒ…
- [ ] ì´ë¯¸ì§€ ìµœì í™”
- [ ] PWA ì„¤ì • (ì„ íƒì‚¬í•­)
- [ ] ë¹Œë“œ ë° ë°°í¬
```

## **4. ì‹¤í–‰ ë° ë°°í¬ ê°€ì´ë“œ**

### **ë¡œì»¬ ê°œë°œ í™˜ê²½ ì‹¤í–‰**

```bash
# 1. ì €ì¥ì†Œ í´ë¡  ë° ì˜ì¡´ì„± ì„¤ì¹˜
git clone <repository-url>
cd mindstock

# 2. ë°±ì—”ë“œ ì„¤ì •
cd backend
npm install
cp .env.example .env
# .env íŒŒì¼ì— API í‚¤ ë“± ì„¤ì •

# 3. ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜
npx prisma migrate dev
npx prisma generate

# 4. ë°±ì—”ë“œ ì„œë²„ ì‹¤í–‰
npm run dev

# 5. í”„ë¡ íŠ¸ì—”ë“œ ì„¤ì • (ìƒˆ í„°ë¯¸ë„)
cd ../frontend
npm install
npm run dev
```

### **í”„ë¡œë•ì…˜ ë°°í¬**

**Dockerë¥¼ í™œìš©í•œ ë°°í¬**

```dockerfile
# backend/Dockerfile
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY . .
RUN npx prisma generate
EXPOSE 3000
CMD ["npm", "start"]
```

```yaml
# docker-compose.yml
version: '3.8'
services:
  backend:
    build: ./backend
    ports:
      - "3000:3000"
    environment:
      - DATABASE_URL=postgresql://user:pass@db:5432/mindstock
      - REDIS_URL=redis://redis:6379
    depends_on:
      - db
      - redis

  frontend:
    build: ./frontend
    ports:
      - "80:80"

  db:
    image: postgres:15
    environment:
      POSTGRES_DB: mindstock
      POSTGRES_USER: user
      POSTGRES_PASSWORD: pass
    volumes:
      - postgres_data:/var/lib/postgresql/data

  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"

volumes:
  postgres_data:
```

ì´ PRDì™€ ê°œë°œ ê°€ì´ë“œë¥¼ í™œìš©í•˜ì—¬ Cursor AIì™€ í•¨ê»˜ íš¨ìœ¨ì ìœ¼ë¡œ ë§ˆì¸ë“œë§µ ê¸°ë°˜ ì£¼ì‹ í¬íŠ¸í´ë¦¬ì˜¤ ê´€ë¦¬ ì„œë¹„ìŠ¤ë¥¼ ê°œë°œí•˜ì‹œê¸° ë°”ëë‹ˆë‹¤. ê° ë‹¨ê³„ì—ì„œ ì œì‹œëœ í”„ë¡¬í”„íŠ¸ë¥¼ Cursor AIì— ì…ë ¥í•˜ë©´ êµ¬ì²´ì ì´ê³  ì‹¤ìš©ì ì¸ ì½”ë“œë¥¼ ìƒì„±ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
---
